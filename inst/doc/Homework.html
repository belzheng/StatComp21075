<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Yu Zheng_21075" />

<meta name="date" content="2021-12-17" />

<title>StatCompHomwork_21075</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">StatCompHomwork_21075</h1>
<h4 class="author">Yu Zheng_21075</h4>
<h4 class="date">2021-12-17</h4>



<div id="all-homework-of-statcomp-fall-term2021-by-yu-zheng-id-21075" class="section level2">
<h2>All homework of StatComp (Fall term,2021) by Yu Zheng (ID: 21075)</h2>
<p>This is an R Markdown document which includes all of the homework during the author studying the lesson, Statistical Computing (lecturer: Prof.Zhang, Fall,2021).</p>
</div>
<div id="section" class="section level2">
<h2>2021/9/16</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>1、texts: 计算ρ(x,sqrt(1-x^2))</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>corr<span class="ot">=</span><span class="cf">function</span>(n)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">runif</span>(n)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>results1<span class="ot">=</span>(<span class="fu">mean</span>(u<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">^</span><span class="dv">2</span>))<span class="sc">-</span><span class="fu">mean</span>(u)<span class="sc">*</span><span class="fu">mean</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span>(<span class="fu">sd</span>(u)<span class="sc">*</span><span class="fu">sd</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>results1</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">corr</span>(<span class="dv">1000000</span>)</span></code></pre></div>
<pre><code>## [1] -0.9212981</code></pre>
<p>2、figures： 画出向量X1、X2、X3两两之间的散点图，可以大概知道变量间的相关关系</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>rubber<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x1=</span><span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">70</span>,<span class="dv">70</span>,<span class="dv">69</span>,<span class="dv">66</span>,<span class="dv">67</span>,<span class="dv">68</span>,<span class="dv">72</span>,<span class="dv">66</span>,<span class="dv">68</span>),<span class="at">x2=</span><span class="fu">c</span>(<span class="dv">45</span>,<span class="dv">45</span>,<span class="dv">48</span>,<span class="dv">46</span>,<span class="dv">50</span>,<span class="dv">46</span>,<span class="dv">47</span>,<span class="dv">43</span>,<span class="dv">47</span>,<span class="dv">48</span>),<span class="at">x3=</span><span class="fu">c</span>(<span class="fl">27.6</span>,<span class="fl">30.7</span>,<span class="fl">31.8</span>,<span class="fl">32.6</span>,<span class="fl">31.0</span>,<span class="fl">31.3</span>,<span class="fl">37.0</span>,<span class="fl">33.6</span>,<span class="fl">33.1</span>,<span class="fl">34.2</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rubber)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3、tables: 制作一张表格,生成名为foo的csv文件</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">##建立数据框</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">Name=</span><span class="fu">c</span>(<span class="st">&quot;张三&quot;</span>,<span class="st">&quot;李四&quot;</span>,<span class="st">&quot;王五&quot;</span>,<span class="st">&quot;赵六&quot;</span>,<span class="st">&quot;丁一&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">Sex=</span><span class="fu">c</span>(<span class="st">&quot;女&quot;</span>,<span class="st">&quot;男&quot;</span>,<span class="st">&quot;女&quot;</span>,<span class="st">&quot;男&quot;</span>,<span class="st">&quot;女&quot;</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>   <span class="at">Age=</span><span class="fu">c</span>(<span class="dv">14</span>,<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">14</span>,<span class="dv">15</span>),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">Height=</span><span class="fu">c</span>(<span class="dv">156</span>,<span class="dv">165</span>,<span class="dv">157</span>,<span class="dv">162</span>,<span class="dv">159</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>   <span class="at">Weight=</span><span class="fu">c</span>(<span class="fl">42.0</span>,<span class="fl">49.0</span>,<span class="fl">41.5</span>,<span class="fl">52.0</span>,<span class="fl">45.5</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>);df</span></code></pre></div>
<pre><code>##   Name Sex Age Height Weight
## 1 张三  女  14    156   42.0
## 2 李四  男  15    165   49.0
## 3 王五  女  16    157   41.5
## 4 赵六  男  14    162   52.0
## 5 丁一  女  15    159   45.5</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(df,<span class="at">file=</span><span class="st">&quot;foo.csv&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">##将数据框转为表格</span></span></code></pre></div>
</div>
<div id="section-1" class="section level2">
<h2>2021/9/23</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R)</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>3.4:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rayleigh<span class="ot">&lt;-</span><span class="cf">function</span>(s)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>{n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>s<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>(x<span class="sc">/</span>s<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>s<span class="sc">^</span><span class="dv">2</span>))))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, y<span class="sc">/</span>s<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>s<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">####模拟σ=1,2,3的三种情况</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rayleigh</span>(<span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6OmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOmZmZgBmZmZmkLZmkNtmtttmtv+QOgCQOjqQZgCQZjqQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa2kJC2tra227a22/+2/7a2/9u2///T09PbkDrbtmbbtpDb27bb2//b/9vb////tmb/tpD/25D/27b/29v//7b//9v///+yClfpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAL80lEQVR4nO2dfWOkthHGZSdeX5JrvXlp2tht2pq7JteeaZua7nV3v//nKgIEAiQ9IxBIkHn+MF5WmhE/hCTErBBXllMidgFSFwMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBAsQGd7oV4TMKkJdv6gHoez8fHa3HzHNK+xSQ6UFtJIgMq7l6vl6egVchiEh2orSSrAxo7lOcusAwmKQdqKok/oMvf/tr+/9/fv5LTWh3md6/IDrA52jc2KWxJLdna7N6APn33Qft0+u4jOa3FYX77EdlBNof7DCaFJak1m9qSAZ2/qRr587f9duz0hf3IhmmNDvO6YXTZQTaH+0wmRS/pp2+FuPnNoNYOsjVbMqCsNPlcNmMPg/1ltbTkGKc1+KvOmtsOsjncZzQp9KSyRy/1+UdntnpLBXR5qvLno47wdG/AUDswdd8Df6c3Ko3dDrI52Gc0KfSklyfxQ1mLnsSDM1u9pQOSPM/H0XluyI1lSDv2l1Wn8tFlB9kc7jOaFHrS8/Fw7TbWbPWWCKiQuQ/l5lB/OlQmH6/dxpBlnFa5u7wrK/lX/eayTvLpx/JSlj1Ily+7/ce7JnVjE/vRTXZ++9krQPaSNFs/QFlTK2VW5S03FLpOM06r3NWnq39pVHaa1uGg58tuf6dSZ2J8HRr9aCY1v/3shfxkLYnael1i5cVbsz0fb38+NvW3EMbm1Zi2V9X/2T/ayk4mflu6eVf1lypfJm7+IvcdOpvQj2ayc9vPfrovv7SXRG29AJ2PykMuvlT/FqIuVX0umtN/NadtAd28/emXgQdp53R/qJ0dtHxZ07LefuxsdjL76Retdat9f7qXZq0labcTAZUnQ9XethS2gmtplbe8qtf9sW4NqIEsT6HKl9X2yx7IDUjzMyzaGFAuPv/gKkm7nQio/E9hgYC0tK23f/+oMPSK1QKSGVS+MSC9shr9DI50BKhkqXxbStJup7VBZRG/V6dLXbGDS8yYVvf2v39902sbpZ3eYEjl6y4xZxuk+9FMam7bpJf+EMhUknbrNw5S3UBR9Wi1N9SLaWmVs7Kp+UWO1HrFyqtW+OYPstGUTVGbL5NXQ9VIO3sxvUyaSd2v3uGBkrRbP0BNN3qWvUXVC1RmnOMgPW3rLNPrWlusx7abL8vb5ctuvlRXnWMc1CuTblLz2yTVL2RrSdR20ki6PgN5dT7QSFpP2805vC/L+NkPfQeVHTlQFG8/6PnKgWK58+3r1TmS1v30TXZ+m6SF6ADZS+I3klaady/mcma3k2lngHAvNjYpcFJTNr97sUb1CKVXPMfd/CCt05fdjg5o7N+8r2dS4KSmbH5380qj+aCv6PNBzgpkt6MDIs0HDU0KmNSUrdl6zyhe/qi7cE3QDdO65LLTA2S0afRjNgmLpLKp7YQ56ffanPSfwZz0e/sEsC5kB9k07LOZBEVS2drssR8cJi8GBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICA/QFn17GkYLrJreQGq+Lx5XiS0OVX5ADofZcRR9eCEFnK5B/kBelRxogUhoHAf8rvEytqTcw2ySwYIVFUo8A90UpZnN18YgiH2LR4HATEgoImA8iC92BbOTpgyilae2YJ4X1SBi+hlTmyhCq0GSJi0AUJ+Jbw8dWHMnubEy1DiRWygGfIqYBsiWRjCcYG5XwMg7ad9tlsNb0DJE/K9WW1ku1n1AFTuEL4liKB4NWiHgLqg+hBtkAKUOCG/0p2P3a+VPM0NAcnPYkoZVtZ64yATINPQKDHFAiTaP9q2q1TpKAlAGiEGxIBs34z56FwYkBtQ1xyFLc98MSCgOIDEsOnpdoUtz3ytNqOIAKlKFaQ8ARWlBhnGPwwIAmp6/rDlma+EAOm3Z+koBiDD+JABUQB1MyAJKSlAzSxsUppSoNO9Nb6MAsj03z4Aqekyx4OfmYBeNj4f1My0zqtBpmtN2+VTnjXUFqisHjjqp14d5NcJqF6tCi72KFc7WhRQaoT65SEwysXDLECmAeN2ANWI3LE/p/vPlgSU2jOOXnFkBOJjs5aSXaaVxIzm+t9QASVGqCuN7MSbxc2mh49BQKZZj20AOh99QnttIXghAKVFqAP0dc1nUvUhT5iZJl5HgJIiNAI0Lzxzt4Cyrg5Q1r1G5kzfeABKidCoBjk1NwTP9PTQBCghQuuG4O0c0PwAKjKgdAjVBTkfH9q5DHsjPTsEzxQCM9yVWkjMqjWIAsjw3WYAzQ3BM0Xh2XclEvGh32o8yFtV533YvBA8P0CJRHx0zjO53vWh+dHufHOjb7YOqHoBmXzzwmIjacMMtBNQGhEfPUDyd/HL3Wp4A0oi4kO7xA5yxrn/PpcZ5kbfbB5Q2QDfPJMWXCaZG32DaJh2JRDxsd6T1SmAEoj4iBXlukFA8E7dz9zom0mA4kd8aI30DDK+IXh0QNEjPrRuftZM2dDc6IsdAAqxJFB4QLEjPlrnczv4gbnR/smAIj9s7ZwXIV5KvWNAhAkzH3Oj/dMBJXKJLWpOTO/FYlchP9+5aN7J7vlkdSagmDPUmuvyIrt7zVydfV691qp6/+C6gCIS0hrpm+dc3s3bCdVz0lXwhxuQceZ9FqB4hLRu/qGainfMB6mhUnb3CgAZjnpuIx2LUG+gKAE5ZhTbpxrZwQuQ6ZGYN6BYhEY1KHPM2iss4/dR9s3tElDTBtneWFgrb18zuT6gSIT6vdjsZWxNgExxHVMAxSG0yEBxIUBRCE306dNIhwMUg9DgXmziEq2DCTPjo4kQgCIQUh6bl9fm8wLMTDUoKKD1CTUO29VrHVH0dHPGx6NhAK1OqPanzZY5n80TQ/CWBLQ2oTaASu1wPXqmhuAtCmhlQgoQjB27egRQGUM0ggFal5APIHII3sKAViW0xRq0KiEfQOQQPGE43llTrhHjOhWgzrVr0p4YghcakGFXYAx2LXsvZrrWwgBajdBWAa3WDG0W0FqEFgVkGjAGA7QSoQ0DWofQlgGtQmhJQKZZj6CA1iC0bUArEArjwTijaJp4DQ1oeUIL1qBVAC1OaPOAlia0HCABjzLQvdiyhHYAaFlCWwW02hTIYoCGRxUYkOFTCoA8nmqsCaj+mAAgj6cao4NaFFD1OT4gnznplQHJHfEB+TzVWBvQy1K/WFioBpkOYFlAS83CerZB1KcaEQC9LNPT+5kkP9WIAuja3TXPgzI+osDmiL9PXaAGhR877gmQg9ncI/KWXyB5PEBtuSaDWmbCbANaF9COxYCAAt+s7k+Bb1b3p8C3Go3RpLUcIGKYFd0oMV2UZFOS02tQWOebAUS4WfUzujtA+GbVz+j+AAU2yoDCpGNAKSabmDysUQYUJt3+AO1JDAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBBQeUEFexur0BX7+WD2qJDyEy8leXYu0GRQckFxHpiCV9XzED2gvT6WpHL9DWEab0LwWnmskhQZUPxqivN6loDzBrlfrge/6qBZnIS34XC03ipN1Cg2IeETVkyPyS2BodYMEKL/7U2RAb+Sx0A6dDIi23H5OwFgWL3IbVJ9sYnNABEQKlSgobblsAPYHqCC8510KvYL5eoVLjRqU/iVGD7WBp6UqXGxA1Eb6SgTksS4fXKAubwJgfNaxi9fN0wC515ZVqtHQauR2BoqUAzrd0+qPPGotOgcl9VD4Ww36oJ8AqLkosMGMfOVEB7QzMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAkodkIxV015Rub5SB6Te8h5NqQO6Frd//3reG8znKXlA14wYBbyQ0gdUeAWlBlfygC5P30ddtTF5QPndf2jRqwspdUByaULyj16WUOqA6gDoiM106oCiiwEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQAwIiAEBMSAgBgTEgIAYEBADAmJAQP8HjNrjepLSCvgAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rayleigh</span>(<span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rayleigh</span>(<span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>总结：由模拟结果知，逆变换法产生的rayleigh随机数的直方图与理论的密度函数拟合得很接近。</p>
<p><br />
3.11：</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mix<span class="ot">&lt;-</span><span class="cf">function</span>(n,p)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>   u<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>   x<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>   {</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>      u[i]<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(u[i]<span class="sc">&lt;</span>p){</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>         x[i]<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>{</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>         x[i]<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">hist</span>(x,<span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">breaks=</span><span class="dv">100</span>,<span class="at">main =</span> p)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>   y<span class="ot">=</span><span class="fu">seq</span>(<span class="fu">min</span>(x),<span class="fu">max</span>(x),<span class="fl">0.01</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">lines</span>(y,p<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="do">##模拟p1=0.75，0.4，0.5，,0.6的四种情况</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mix</span>(<span class="at">n =</span> <span class="dv">1000</span>,<span class="at">p=</span><span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mix</span>(<span class="at">n =</span> <span class="dv">1000</span>,<span class="at">p=</span><span class="fl">0.4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mix</span>(<span class="at">n =</span> <span class="dv">1000</span>,<span class="at">p=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mix</span>(<span class="at">n =</span> <span class="dv">1000</span>,<span class="at">p=</span><span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>总结：由图可得，当p1=0.5时，密度函数会出现双峰。</p>
<p><br />
3.20:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">##生成泊松过程和伽马分布的复合随机变量，其中泊松过程参数为lambda，伽马分布的参数为r和beta</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>crp<span class="ot">=</span><span class="cf">function</span>(n,lambda,r,beta)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>{  x<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>      n<span class="ot">=</span><span class="fu">rpois</span>(<span class="dv">1</span>,<span class="dv">10</span><span class="sc">*</span>lambda)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      y<span class="ot">=</span><span class="fu">rgamma</span>(n,r,beta)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>      x[i]<span class="ot">=</span><span class="fu">sum</span>(y)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>   estimate<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(x),<span class="fu">var</span>(x))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>   theore<span class="ot">=</span><span class="fu">c</span>(<span class="dv">10</span><span class="sc">*</span>lambda<span class="sc">*</span>r<span class="sc">/</span>beta,<span class="dv">10</span><span class="sc">*</span>lambda<span class="sc">*</span>(r<span class="sc">/</span>(beta<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span>(r<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(beta<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">list</span>(<span class="at">estimate=</span>estimate,<span class="at">theore=</span>theore)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="do">##选择不同的参数进行模拟</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="fu">crp</span>(<span class="dv">10000</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## $estimate
## [1] 10.00453 20.34145
## 
## $theore
## [1] 10 20</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crp</span>(<span class="dv">10000</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## $estimate
## [1] 15.00244 10.96982
## 
## $theore
## [1] 15.00 11.25</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crp</span>(<span class="dv">10000</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## $estimate
## [1] 30.04144 23.48411
## 
## $theore
## [1] 30 24</code></pre>
<p>总结：由三次模拟的结果可知，当产生10000个模拟的随机数时，复合随机变量的均值和方差的模拟值和理论值非常接近，说明模拟效果比较好。</p>
</div>
<div id="section-2" class="section level2">
<h2>2021/9/30</h2>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>5.4:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="cf">function</span>(q)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>   n<span class="ot">=</span><span class="fu">length</span>(q)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>   theta.hat<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,n)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      g<span class="ot">=</span><span class="cf">function</span>(u)q[i]<span class="sc">*</span><span class="dv">30</span><span class="sc">*</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      y<span class="ot">=</span><span class="fu">runif</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,q[i])</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      theta.hat[i]<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">g</span>(y))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>   theta.hat</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>q<span class="ot">=</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">MCe=</span><span class="fu">round</span>(<span class="fu">beta</span>(q),<span class="dv">5</span>),<span class="at">ture=</span><span class="fu">pbeta</span>(q,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## $MCe
## [1] 0.00856 0.05799 0.16323 0.31755 0.49985 0.68259 0.83659 0.94204 0.99130
## 
## $ture
## [1] 0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208 0.99144</code></pre>
<p>总结：由模拟结果知，用Monte Carlo方法估计的beta(3,3)的cdf与R中的pbeta函数计算出来的cdf是很接近的。</p>
<p><br />
5.9：</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>raylaigh<span class="ot">=</span><span class="cf">function</span>(x,<span class="at">s=</span>sigma)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">50000</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">runif</span>(m,<span class="dv">0</span>,x)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>T1<span class="ot">=</span>(x<span class="sc">*</span>u<span class="sc">/</span>s<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>s<span class="sc">^</span><span class="dv">2</span>))<span class="sc">+</span>x<span class="sc">*</span>(x<span class="sc">-</span>u)<span class="sc">/</span>s<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="sc">-</span>u)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>s<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>u1<span class="ot">=</span><span class="fu">runif</span>(m,<span class="dv">0</span>,x)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>T2<span class="ot">=</span>(x<span class="sc">*</span>u<span class="sc">/</span>s<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>s<span class="sc">^</span><span class="dv">2</span>))<span class="sc">+</span>x<span class="sc">*</span>u1<span class="sc">/</span>s<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>u1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>s<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">meanT1=</span><span class="fu">mean</span>(T1),<span class="at">meanT2=</span><span class="fu">mean</span>(T2),<span class="at">varT1=</span><span class="fu">var</span>(T1)<span class="sc">/</span>m,<span class="at">varT2=</span><span class="fu">var</span>(T2)<span class="sc">/</span>m,<span class="at">percent_reduction=</span>(<span class="fu">var</span>(T2)<span class="sc">-</span><span class="fu">var</span>(T1))<span class="sc">/</span><span class="fu">var</span>(T2))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="do">##取x=1，sigma=2</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">raylaigh</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## $meanT1
## [1] 0.1174924
## 
## $meanT2
## [1] 0.1175129
## 
## $varT1
## [1] 2.118447e-10
## 
## $varT2
## [1] 4.144339e-08
## 
## $percent_reduction
## [1] 0.9948883</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">##取x=2，sigma=2</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">raylaigh</span>(<span class="dv">2</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## $meanT1
## [1] 0.3933876
## 
## $meanT2
## [1] 0.3944436
## 
## $varT1
## [1] 3.473663e-08
## 
## $varT2
## [1] 3.477287e-07
## 
## $percent_reduction
## [1] 0.9001042</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">##取x=3，sigma=2</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">raylaigh</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## $meanT1
## [1] 0.6753149
## 
## $meanT2
## [1] 0.6768029
## 
## $varT1
## [1] 4.393398e-07
## 
## $varT2
## [1] 6.707792e-07
## 
## $percent_reduction
## [1] 0.3450307</code></pre>
<p>总结：由三次模拟结果知，当x与x’负相关时计算rayleigh（2）的cdf和当x1与x2独立时产生的rayleigh（2）的cdf是相近的，但是用对偶变量法产生的rayleigh（2）分布的估计的方差确实比独立变量产生的方差要小。说明对偶变量法能够有效缩减方差。</p>
<p><br />
5.13:取f1为标准正态分布的密度函数，f2为参数为1的指数分布。且由后面的模拟结果知，选取f2为 importance function时，积分估计会有较小的方差。</p>
<p><br />
5.14:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">##取f为标准正态分布的密度函数</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e6</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(m)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>g<span class="ot">=</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(x<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">theta.hat=</span><span class="fu">mean</span>(g),<span class="at">vartheta.hat=</span><span class="fu">var</span>(g)<span class="sc">/</span>m)</span></code></pre></div>
<pre><code>## $theta.hat
## [1] 0.4007908
## 
## $vartheta.hat
## [1] 1.290095e-06</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">##取f为指数分布的密度函数</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">rexp</span>(m)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>g1<span class="ot">=</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(y<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(y<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">theta1.hat=</span><span class="fu">mean</span>(g1),<span class="at">vartheta1.hat=</span><span class="fu">var</span>(g1)<span class="sc">/</span>m)</span></code></pre></div>
<pre><code>## $theta1.hat
## [1] 0.4005636
## 
## $vartheta1.hat
## [1] 3.434265e-07</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(g)<span class="sc">/</span><span class="fu">var</span>(g1))</span></code></pre></div>
<pre><code>## [1] 3.756539</code></pre>
<p>总结： 1.由重要抽样法估计该积分为0.4左右； 2.由两者方差比值大于1知，取 importance function为指数分布（λ=1）的密度函数时，积分估计的方差较小，取importance function为标准正态分布的密度函数时，积分估计的方差较大。</p>
</div>
<div id="section-3" class="section level2">
<h2>2021-10-14</h2>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>一、Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).\ 二、If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.\ 1.What is the corresponding hypothesis test problem?\ 2.What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?\ 3.Please provide the least necessary information for hypothesis testing</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(\mathbf{Answer1-6.5}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>CI<span class="ot">=</span><span class="cf">function</span>(m,n,alpha){</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>   ucl<span class="ot">=</span>lcl<span class="ot">=</span>cp<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>      x<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>      ucl[i]<span class="ot">=</span><span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>      lcl[i]<span class="ot">=</span><span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>      cp[i]<span class="ot">=</span><span class="fu">as.numeric</span>(ucl[i]<span class="sc">&gt;=</span><span class="dv">2</span><span class="sc">&amp;&amp;</span>lcl[i]<span class="sc">&lt;=</span><span class="dv">2</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">mean</span>(cp))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">CI</span>(<span class="at">m=</span><span class="dv">1000</span>,<span class="at">n=</span><span class="dv">20</span>,<span class="at">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.929</code></pre>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> compared with example6.4, when the data comes from chi-square distribution, the confidence interval coverage ratio CP of mean test is greater than 0.95, which is 1, which is more robust than 0.773 of variance test, because the deviation is less.</p>
<p><span class="math inline">\(\mathbf{Answer2-6.A}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span><span class="cf">function</span>(m,n,alpha){</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>   p.val1<span class="ot">=</span>p.val2<span class="ot">=</span>p.val3<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>   x1<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">1</span>)<span class="do">##x~chisq(1)</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>   p.val1[i]<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(x1)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sd</span>(x1)),n<span class="dv">-1</span>))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>   x2<span class="ot">=</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)<span class="do">##x~u(0,2)</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>   p.val2[i]<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(x2)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sd</span>(x2)),n<span class="dv">-1</span>))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>   x3<span class="ot">=</span><span class="fu">rexp</span>(<span class="dv">20</span>,<span class="dv">1</span>)<span class="co">#x~exp(1)</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>   p.val3[i]<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(<span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(x3)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sd</span>(x3)),n<span class="dv">-1</span>))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">chisq=</span><span class="fu">mean</span>(p.val1<span class="sc">&lt;=</span>alpha),<span class="at">uniform=</span><span class="fu">mean</span>(p.val2<span class="sc">&lt;=</span>alpha),<span class="at">exponential=</span><span class="fu">mean</span>(p.val3<span class="sc">&lt;=</span>alpha))</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">test</span>(<span class="at">m=</span><span class="dv">10000</span>,<span class="at">alpha=</span><span class="fl">0.01</span>,<span class="at">n=</span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>## $chisq
## [1] 0.0549
## 
## $uniform
## [1] 0.0123
## 
## $exponential
## [1] 0.0326</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test</span>(<span class="at">m=</span><span class="dv">10000</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,<span class="at">n=</span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>## $chisq
## [1] 0.104
## 
## $uniform
## [1] 0.0527
## 
## $exponential
## [1] 0.0836</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test</span>(<span class="at">m=</span><span class="dv">10000</span>,<span class="at">alpha=</span><span class="fl">0.1</span>,<span class="at">n=</span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>## $chisq
## [1] 0.1544
## 
## $uniform
## [1] 0.0969
## 
## $exponential
## [1] 0.1343</code></pre>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> when the sampled population is Uniform(0,2)，the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α，while the simulation results of Chi-square (1) and exponential (rate=1) distribution are not very close to the nominal significance level α.so The t-test is robust to mild departures from normality.</p>
<p><span class="math inline">\(\mathbf{Question3- Discussion }\)</span></p>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p><span class="math inline">\(1:\)</span>What is the corresponding hypothesis test problem?<br />
<span class="math inline">\(solve:\)</span> Suppose the power function of the first method is <span class="math inline">\(power_{1}\)</span>, and the power function of the second method is <span class="math inline">\(power_{2}\)</span>,then<span class="math display">\[H_{0}:power_{1}=power_{2}\leftrightarrow H_{1}:power_{1}\neq power_{2}\]</span></p>
<p><span class="math inline">\(2:\)</span> What test should we use? Z-test, two-sample t-test, paired-t-test or McNemar test?<br />
<span class="math inline">\(solve:\)</span>We can use paired-t-test or Z-test or McNemar test but not two-sample t-test.Because two-sample t-test requires two samples to be independent.</p>
<p>McNemar Test : First, the data is preprocessed, that is, if <span class="math inline">\(H_0\)</span>is true, <span class="math inline">\(\frac {(x_i-y_i)^2} {x_i+y_i} \sim \chi^2_1\)</span>, and the null hypothesis is tested according to this expression.</p>
<p><span class="math inline">\(3:\)</span> What information is needed to test your hypothesis?<br />
<span class="math inline">\(solve:\)</span>We need the power function generated from the sample data and the corresponding <span class="math inline">\(\frac {(x_i-y_i)^2} {x_i+y_i} \sim \chi^2_1\)</span>.The two sample need have same sample size and parameter.We also need the chi-square quantile.</p>
</div>
<div id="section-4" class="section level2">
<h2>2021-10-21</h2>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R).</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(\mathbf{Answer1-6.C}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Examples 6.8</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#The dimension of multivariate normal variables is two-dimension.</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>) <span class="co">#sample size</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,d<span class="sc">*</span>(d <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">*</span>(d <span class="sc">+</span> <span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) <span class="co">#crit.values for each n</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>msk <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  msk <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(<span class="fu">diag</span>(((x<span class="sc">-</span>xbar)<span class="sc">%*%</span><span class="fu">solve</span>(<span class="fu">cov</span>(x))<span class="sc">%*%</span><span class="fu">t</span>(x<span class="sc">-</span>xbar))<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(msk<span class="sc">*</span>n<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  <span class="co">#test decisions</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[i],<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),s)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">msk</span>(x) <span class="sc">&gt;=</span> cv)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)  <span class="co">#proportion rejected</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.0629 0.0813 0.1017 0.1128 0.1211 0.1276 0.0730</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Examples 6.10</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">30</span> <span class="co">#sample sizes </span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) <span class="co">#crit. values for each n</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span><span class="cf">function</span>(x) { </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">nrow</span>(x)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d) {</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    x[,j]<span class="ot">&lt;-</span>x[,j]<span class="sc">-</span><span class="fu">mean</span>(x[,j])</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span><span class="fu">solve</span>(<span class="fu">cov</span>(x))</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>n<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(<span class="fu">diag</span>((x<span class="sc">%*%</span>s<span class="sc">%*%</span><span class="fu">t</span>(x))<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b<span class="sc">*</span>n<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2500</span> <span class="co">#replicates</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">01</span>), <span class="fu">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, .<span class="dv">05</span>)) </span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon) </span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co">#critical value for the skewness test </span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j] </span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) </span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    sig <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nr=</span>n,<span class="at">nc=</span>d)</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>      sigma<span class="ot">&lt;-</span><span class="fu">diag</span>(<span class="fu">rep</span>(sig[k],d))</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>       x[k,]<span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,d),sigma)</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>    sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sk</span>(x) <span class="sc">&gt;=</span> cv) </span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>  pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests) </span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon </span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pwr, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>) </span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pwr) <span class="sc">/</span> m) <span class="co">#add standard errors </span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>) </span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-5" class="section level2">
<h2>2021-10-28</h2>
</div>
<div id="question-5" class="section level2">
<h2>question</h2>
<p>Exercises 7.7, 7.8, 7.9, and 7.B (pages 213, Statistical Computating with R)</p>
<p><span class="math inline">\(\mathbf{Answer1-7.7}\)</span> The R code for this question is as follows:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     corr</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>lambda_hat<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>theta_hat<span class="ot">=</span>lambda_hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda_hat)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>B<span class="ot">=</span><span class="dv">2000</span> <span class="do">##number of replictes</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>theta_star<span class="ot">=</span><span class="cf">function</span>(data,index){</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>data[index,]</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">=</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>bootstrap_result<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span><span class="fu">cbind</span>(scor<span class="sc">$</span>mec, scor<span class="sc">$</span>vec, scor<span class="sc">$</span>alg, scor<span class="sc">$</span>ana, scor<span class="sc">$</span>sta),<span class="at">statistic =</span> theta_star, <span class="at">R =</span> B)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>theta_b <span class="ot">&lt;-</span> bootstrap_result<span class="sc">$</span>t</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>bias_boot <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta_b) <span class="sc">-</span> theta_hat<span class="co"># the estimated bias of theta_hat, using bootstrap</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>se_boot <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(theta_b))<span class="co"># the estimated standard error (se) of theta_hat, using bootstrap</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co"># print the answers</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">bias_boot=</span>bias_boot,<span class="at">se_boot=</span>se_boot)</span></code></pre></div>
<pre><code>## $bias_boot
## [1] 0.00260599
## 
## $se_boot
##            [,1]
## [1,] 0.04689501</code></pre>
<p><span class="math inline">\(\mathbf{Answer1-7.8}\)</span> The R code for this question is as follows:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>lambda_hat<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>theta_hat<span class="ot">=</span>lambda_hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda_hat)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(scor)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>theta_j<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  theta_j[i]<span class="ot">=</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>bias_jack<span class="ot">=</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta_j)<span class="sc">-</span>theta_hat)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>se_jack<span class="ot">=</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>(((theta_j<span class="sc">-</span><span class="fu">mean</span>(theta_j))<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co">#print the answers</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">bias_jack=</span>bias_jack,<span class="at">se_jack=</span>se_jack)</span></code></pre></div>
<pre><code>## $bias_jack
## [1] 0.001069139
## 
## $se_jack
## [1] 0.04955231</code></pre>
<p><span class="math inline">\(\mathbf{Answer1-7.9}\)</span> The R code for this question is as follows:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>lambda_hat<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>theta_hat<span class="ot">=</span>lambda_hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda_hat)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>B<span class="ot">=</span><span class="dv">2000</span> <span class="do">##number of replictes</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>theta_star<span class="ot">=</span><span class="cf">function</span>(data,index){</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>data[index,]</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">=</span>lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>bootstrap_result<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span><span class="fu">cbind</span>(scor<span class="sc">$</span>mec, scor<span class="sc">$</span>vec, scor<span class="sc">$</span>alg, scor<span class="sc">$</span>ana, scor<span class="sc">$</span>sta),<span class="at">statistic =</span> theta_star, <span class="at">R =</span> B)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(bootstrap_result,<span class="at">conf =</span> <span class="fl">0.95</span>,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_result, conf = 0.95, type = c(&quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5283,  0.7083 )   ( 0.5235,  0.7057 )  
## Calculations and Intervals on Original Scale</code></pre>
<p><span class="math inline">\(\mathbf{Answer1-7.B}\)</span> The R code for this question is as follows:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e3</span><span class="co">#number of replicates</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># normal populations</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>ci_norm.norm<span class="ot">=</span>ci_norm.basic<span class="ot">=</span>ci_norm.perc<span class="ot">=</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>boot_skew<span class="ot">=</span><span class="cf">function</span>(x,i){</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x[i]))<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x[i]))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span>(<span class="fl">1.5</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rnorm</span>(n)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  de<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>boot_skew, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  ci_norm<span class="ot">=</span><span class="fu">boot.ci</span>(de,<span class="at">conf=</span><span class="fl">0.95</span>,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  ci_norm.norm[i,]<span class="ot">=</span>ci_norm<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci_norm.basic[i,]<span class="ot">=</span>ci_norm<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci_norm.perc[i,]<span class="ot">=</span>ci_norm<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co"># $chisq$(5) distribution</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>ci_chisq.norm<span class="ot">=</span>ci_chisq.basic<span class="ot">=</span>ci_chisq.perc<span class="ot">=</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  de<span class="ot">=</span><span class="fu">boot</span>(<span class="at">data=</span>y,<span class="at">statistic=</span>boot_skew, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  ci_chisq<span class="ot">=</span><span class="fu">boot.ci</span>(de,<span class="at">conf=</span><span class="fl">0.95</span>,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  ci_chisq.norm[i,]<span class="ot">=</span>ci_chisq<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci_chisq.basic[i,]<span class="ot">=</span>ci_chisq<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci_chisq.perc[i,]<span class="ot">=</span>ci_chisq<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>chisq.skew<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">8</span><span class="sc">/</span><span class="dv">5</span>)<span class="co">#the skewness of chisquare distribution</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>coverage_rate<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci_norm.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> ci_norm.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci_norm.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> ci_norm.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci_norm.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> ci_norm.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci_chisq.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>chisq.skew <span class="sc">&amp;</span> ci_chisq.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>chisq.skew),</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci_chisq.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>chisq.skew <span class="sc">&amp;</span> ci_chisq.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>chisq.skew),</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mean</span>(ci_chisq.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>chisq.skew <span class="sc">&amp;</span> ci_chisq.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>chisq.skew))</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>proportipn_miss_on_the_left<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci_norm.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">0</span>),</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(ci_norm.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">0</span>),</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(ci_norm.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">0</span>),</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(ci_chisq.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>chisq.skew),</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(ci_chisq.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>chisq.skew),</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mean</span>(ci_chisq.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>chisq.skew))</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>proportipn_miss_on_the_right<span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci_norm.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span>),</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mean</span>(ci_norm.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span>),</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mean</span>(ci_norm.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span>),</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mean</span>(ci_chisq.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>chisq.skew),</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mean</span>(ci_chisq.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>chisq.skew),</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mean</span>(ci_chisq.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>chisq.skew))</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>cinames<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;ci_norm.norm&quot;</span>,<span class="st">&quot;ci_norm.basic&quot;</span>,<span class="st">&quot;ci_norm.perc&quot;</span>,<span class="st">&quot;ci_chisq.norm&quot;</span>,<span class="st">&quot;ci_chisq.basic&quot;</span>,<span class="st">&quot;ci_chisq.perc&quot;</span>)</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">cinames=</span>cinames,<span class="at">coverage_rate=</span>coverage_rate,<span class="at">proportipn_miss_on_the_left=</span>proportipn_miss_on_the_left,<span class="at">proportipn_miss_on_the_right=</span>proportipn_miss_on_the_right)</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(df) </span></code></pre></div>
<table>
<colgroup>
<col width="17%" />
<col width="16%" />
<col width="32%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">cinames</th>
<th align="right">coverage_rate</th>
<th align="right">proportipn_miss_on_the_left</th>
<th align="right">proportipn_miss_on_the_right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ci_norm.norm</td>
<td align="right">0.975</td>
<td align="right">0.006</td>
<td align="right">0.019</td>
</tr>
<tr class="even">
<td align="left">ci_norm.basic</td>
<td align="right">0.967</td>
<td align="right">0.007</td>
<td align="right">0.026</td>
</tr>
<tr class="odd">
<td align="left">ci_norm.perc</td>
<td align="right">0.982</td>
<td align="right">0.002</td>
<td align="right">0.016</td>
</tr>
<tr class="even">
<td align="left">ci_chisq.norm</td>
<td align="right">0.869</td>
<td align="right">0.065</td>
<td align="right">0.066</td>
</tr>
<tr class="odd">
<td align="left">ci_chisq.basic</td>
<td align="right">0.854</td>
<td align="right">0.095</td>
<td align="right">0.051</td>
</tr>
<tr class="even">
<td align="left">ci_chisq.perc</td>
<td align="right">0.849</td>
<td align="right">0.043</td>
<td align="right">0.108</td>
</tr>
</tbody>
</table>
</div>
<div id="section-6" class="section level2">
<h2>2021-11-04</h2>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>一、Exercise 8.2 (page 242, Statistical Computating with R). 二、Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations. 1. Unequal variances and equal expectations 2. Unequal variances and unequal expectations 3. Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) 4. Unbalanced samples (say, 1 case versus 10 controls) 5. Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(\mathbf{Answer1-8.2}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>]))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(x,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## 226 295 297 318 320 322 334 339 340 341 392 423</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(y,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## 141 148 169 181 203 213 229 244 257 260 271 309</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co"># pooled sample</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1500</span>;K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>;n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R);t0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y,<span class="at">method =</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z[k]; y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>reps[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1, y1,<span class="at">method =</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p,<span class="fu">cor.test</span>(x,y)<span class="sc">$</span>p.value),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.001 0.000</code></pre>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> Here the sample evidence supports the alternative hypothesis that the variables are highly correlated.</p>
<p><span class="math inline">\(\mathbf{Answer2}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z);</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;=</span> n1); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>(i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Power comparison </span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span>; k<span class="ot">&lt;-</span><span class="dv">1</span>; <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">50</span>; R<span class="ot">&lt;-</span><span class="dv">999</span>; n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2; N <span class="ot">&lt;-</span> <span class="fu">c</span>(n1,n2);</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a><span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>p1.values <span class="ot">&lt;-</span> p2.values<span class="ot">&lt;-</span>p3.values<span class="ot">&lt;-</span>p4.values<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Unequal variances and equal expectations</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1,<span class="dv">0</span>,<span class="fl">1.5</span>)</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> <span class="fu">c</span>(x1,y1)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>p1.values[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z1,N,k)<span class="sc">$</span>p.value</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>p1.values[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z1,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>p1.values[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x1,<span class="at">y=</span>y1,<span class="at">num.permutations=</span>R,</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a><span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a><span class="co">#Unequal variances and unequal expectations</span></span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1,<span class="dv">0</span>,<span class="fl">1.5</span>)</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">c</span>(x2,y2)</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>p2.values[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z2,N,k)<span class="sc">$</span>p.value</span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>p2.values[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z2,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>p2.values[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x2,<span class="at">y=</span>y2,<span class="at">num.permutations=</span>R,</span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a><span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a><span class="co">#Non-normal distributions: t distribution with 1 df (heavy-tailed distribution),bimodel distribution (mixture of two normal distributions)</span></span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>rMG <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly generate n points from the Mixed Gaussian distribution</span></span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> r</span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which</span>(r <span class="sc">&lt;</span> <span class="fl">0.3</span>) <span class="co">#index for those generated from N(0,1)</span></span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>x[ind] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(ind), <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span>ind] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n<span class="sc">-</span><span class="fu">length</span>(ind), <span class="dv">1</span>, <span class="fl">0.3</span>)</span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(x)</span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rt</span>(n1,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">rMG</span>(n2)</span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>z3 <span class="ot">&lt;-</span> <span class="fu">c</span>(x3,y3)</span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a>p3.values[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z3,N,k)<span class="sc">$</span>p.value</span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a>p3.values[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z3,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>p3.values[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x3,<span class="at">y=</span>y3,<span class="at">num.permutations=</span>R,</span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a><span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a><span class="co">#Unbalanced samples</span></span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2)</span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a>z4 <span class="ot">&lt;-</span> <span class="fu">c</span>(x4,y4)</span>
<span id="cb61-73"><a href="#cb61-73" aria-hidden="true" tabindex="-1"></a>p4.values[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.nn</span>(z4,<span class="fu">c</span>(<span class="dv">5</span>,n2),k)<span class="sc">$</span>p.value</span>
<span id="cb61-74"><a href="#cb61-74" aria-hidden="true" tabindex="-1"></a>p4.values[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z4,<span class="at">sizes=</span><span class="fu">c</span>(<span class="dv">5</span>,n2),<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb61-75"><a href="#cb61-75" aria-hidden="true" tabindex="-1"></a>p4.values[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x4,<span class="at">y=</span>y4,<span class="at">num.permutations=</span>R,</span>
<span id="cb61-76"><a href="#cb61-76" aria-hidden="true" tabindex="-1"></a><span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb61-77"><a href="#cb61-77" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-78"><a href="#cb61-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-79"><a href="#cb61-79" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>;</span>
<span id="cb61-80"><a href="#cb61-80" aria-hidden="true" tabindex="-1"></a>pow1 <span class="ot">&lt;-</span><span class="fu">colMeans</span>(p1.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb61-81"><a href="#cb61-81" aria-hidden="true" tabindex="-1"></a>pow2 <span class="ot">&lt;-</span><span class="fu">colMeans</span>(p2.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb61-82"><a href="#cb61-82" aria-hidden="true" tabindex="-1"></a>pow3 <span class="ot">&lt;-</span><span class="fu">colMeans</span>(p3.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb61-83"><a href="#cb61-83" aria-hidden="true" tabindex="-1"></a>pow4 <span class="ot">&lt;-</span><span class="fu">colMeans</span>(p4.values<span class="sc">&lt;</span>alpha)</span>
<span id="cb61-84"><a href="#cb61-84" aria-hidden="true" tabindex="-1"></a>test_names<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot; ball&quot;</span>)</span>
<span id="cb61-85"><a href="#cb61-85" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">test_names=</span>test_names,<span class="at">uneqva_eqme=</span>pow1,<span class="at">uneqva_uneqme=</span>pow2,<span class="at">Non_normal_dist=</span>pow3,<span class="at">Unbalanced_samples=</span>pow4)</span>
<span id="cb61-86"><a href="#cb61-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb61-87"><a href="#cb61-87" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(df)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">test_names</th>
<th align="right">uneqva_eqme</th>
<th align="right">uneqva_uneqme</th>
<th align="right">Non_normal_dist</th>
<th align="right">Unbalanced_samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NN</td>
<td align="right">0.123</td>
<td align="right">0.352</td>
<td align="right">0.855</td>
<td align="right">0.044</td>
</tr>
<tr class="even">
<td align="left">energy</td>
<td align="right">0.253</td>
<td align="right">0.989</td>
<td align="right">1.000</td>
<td align="right">0.046</td>
</tr>
<tr class="odd">
<td align="left">ball</td>
<td align="right">0.479</td>
<td align="right">0.977</td>
<td align="right">1.000</td>
<td align="right">0.048</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> It is known by the output result that: 1.In the situation of Unequal variances and equal expectations,the energy,and ball methods perform better than NN. 2.In the situation of Unequal variances and unequal expectations,the energy,and ball methods perform better than NN,and the energy method perform best among the three. 3.In the situation of Non-normal distributions,the energy,and ball methods perform better than NN. 4.In the situation of Unbalanced samples,all of them perform not good.</p>
</div>
<div id="section-7" class="section level2">
<h2>2021-11-11</h2>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>一、Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R) 二、For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span> &lt; 1.2.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(\mathbf{Answer1-9.3}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>cauchy.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#generates a Metropolis chain for standard Cauchy distribution</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">#and starting value X1</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co">#candidate point</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, y, sigma)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, xt, sigma)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(x)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">cauchy.chain</span>(<span class="fl">0.05</span>,m,<span class="sc">-</span><span class="dv">10</span>)</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">=</span><span class="fu">cauchy.chain</span>(<span class="fl">0.5</span>,m,<span class="sc">-</span><span class="dv">10</span>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">=</span><span class="fu">cauchy.chain</span>(<span class="dv">2</span>,m,<span class="sc">-</span><span class="dv">10</span>)</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>x4<span class="ot">=</span><span class="fu">cauchy.chain</span>(<span class="dv">4</span>,m,<span class="sc">-</span><span class="dv">10</span>)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co">#discard the burn-in sample</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> x1[b<span class="sc">:</span>m]</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> x2[b<span class="sc">:</span>m]</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>z3 <span class="ot">&lt;-</span> x3[b<span class="sc">:</span>m]</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>z4 <span class="ot">&lt;-</span> x4[b<span class="sc">:</span>m]</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>deciles <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>deciles_cauchy<span class="ot">&lt;-</span><span class="fu">qcauchy</span>(deciles)</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>deciles_mcmc1<span class="ot">&lt;-</span><span class="fu">quantile</span>(z1, deciles)</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>deciles_mcmc2<span class="ot">&lt;-</span><span class="fu">quantile</span>(z2, deciles)</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>deciles_mcmc3<span class="ot">&lt;-</span><span class="fu">quantile</span>(z3, deciles)</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>deciles_mcmc4<span class="ot">&lt;-</span><span class="fu">quantile</span>(z4, deciles)</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">deciles_cauchy=</span>deciles_cauchy,<span class="at">sigma_0.05=</span>deciles_mcmc1,<span class="at">sigma_0.5=</span>deciles_mcmc2,<span class="at">sigma_2=</span>deciles_mcmc3,<span class="at">sigma_4=</span>deciles_mcmc4)</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(df)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">deciles_cauchy</th>
<th align="right">sigma_0.05</th>
<th align="right">sigma_0.5</th>
<th align="right">sigma_2</th>
<th align="right">sigma_4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0%</td>
<td align="right">-Inf</td>
<td align="right">-9.7493558</td>
<td align="right">-19.1049434</td>
<td align="right">-29.6253155</td>
<td align="right">-62.7170471</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-3.0776835</td>
<td align="right">-6.6998820</td>
<td align="right">-3.2684724</td>
<td align="right">-2.0238311</td>
<td align="right">-2.7220157</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-1.3763819</td>
<td align="right">-4.3593178</td>
<td align="right">-1.3692079</td>
<td align="right">-0.9026442</td>
<td align="right">-1.3442588</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.7265425</td>
<td align="right">-2.3156301</td>
<td align="right">-0.7903224</td>
<td align="right">-0.3728767</td>
<td align="right">-0.6984481</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.3249197</td>
<td align="right">-1.6082802</td>
<td align="right">-0.3733909</td>
<td align="right">-0.0203981</td>
<td align="right">-0.3246329</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">0.0000000</td>
<td align="right">-1.0725726</td>
<td align="right">-0.0493239</td>
<td align="right">0.3633603</td>
<td align="right">0.0067298</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.3249197</td>
<td align="right">-0.6831266</td>
<td align="right">0.2579210</td>
<td align="right">0.8490142</td>
<td align="right">0.3428611</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.7265425</td>
<td align="right">-0.2561617</td>
<td align="right">0.6192021</td>
<td align="right">1.8466880</td>
<td align="right">0.8413616</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">1.3763819</td>
<td align="right">0.2514100</td>
<td align="right">1.0939872</td>
<td align="right">7.0654727</td>
<td align="right">1.5387611</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">3.0776835</td>
<td align="right">1.0631313</td>
<td align="right">2.0310930</td>
<td align="right">32.9370197</td>
<td align="right">4.3374721</td>
</tr>
<tr class="odd">
<td align="left">100%</td>
<td align="right">Inf</td>
<td align="right">1.7227439</td>
<td align="right">13.5425764</td>
<td align="right">75.7522876</td>
<td align="right">55.6191224</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> We can see that the deciles of the generated observations are in similar with the deciles of the standard Cauchy distribution when sigma equals 0.5.</p>
<p><span class="math inline">\(\textbf{Answer1-continued:Gelman-Rubin method of monitoring convergence for 9.3}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gelman-Rubin method of monitoring convergence</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>cauchy.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="co">#generates a Metropolis chain for standard Cauchy distribution</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="co">#and starting value X1</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co">#candidate point</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, y, sigma)</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, xt, sigma)</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(x)</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>sigma0 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>X[i, ] <span class="ot">&lt;-</span> <span class="fu">cauchy.chain</span>(sigma0, n, x0[i])</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.457103</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">2.5</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> From this plot it is evident that the chain is converging around 8000.The value of <span class="math inline">\(\hat{R}\)</span> is close to 1.2 within time 8000.</p>
<p><span class="math inline">\(\mathbf{Answer2-9.8}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">5000</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>) <span class="co">#initialize</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a, n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]),</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\textbf{Answer2_continued-9.8}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Gelman-Rubin method of monitoring convergence</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>cauchy.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="co">#generates a Metropolis chain for standard Cauchy distribution</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a><span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="co">#and starting value X1</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co">#candidate point</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, y, sigma)</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, xt, sigma)</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(x)</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>sigma0 <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>X[i, ] <span class="ot">&lt;-</span> <span class="fu">cauchy.chain</span>(sigma0, n, x0[i])</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 4.527671</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n],<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">2.5</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-8" class="section level2">
<h2>2021-11-18</h2>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>一、Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R) 二、Suppose <span class="math inline">\({T}_{1}, . . . , {T}_{n}\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>.Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_{i}=T_{i} l\left(T_{i} \leq \tau\right)+\tau l\left(T_{i}&gt;\tau\right)\)</span>, <span class="math inline">\(i=1, \ldots, n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_{i}\)</span> values are as follows: <span class="math display">\[
0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85
\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>,compare your result with the observed data MLE (note: <span class="math inline">\({Y}_{i}\)</span> follows a mixture distribution).</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(\mathbf{Answer1-11.3}\)</span> Solve: The R code for this question is as follows: <span class="math inline">\(\textbf{(a)Write a function to compute the k_th term：}\)</span></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>kth_term<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  a0<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(a)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  a_norm<span class="ot">&lt;-</span><span class="fu">norm</span>(a0,<span class="st">&quot;2&quot;</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  tmp<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span>a_norm<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>k<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  kthterm<span class="ot">&lt;-</span>tmp<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="fl">+1.5</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(kthterm)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kth_term</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 7.232135e-124</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kth_term</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">400</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p><span class="math inline">\(\textbf{(b)Modify the function so that it computes and returns the sum：}\)</span>\ <span class="math inline">\(\textbf{(c)Evaluate the sum when a=(1,2):}\)</span></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>kth_term<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  a0<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(a)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  a_norm<span class="ot">&lt;-</span><span class="fu">norm</span>(a0,<span class="st">&quot;2&quot;</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  tmp<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span>a_norm<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>k<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  kthterm<span class="ot">&lt;-</span>tmp<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="fl">+1.5</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(kthterm)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>mysum<span class="ot">&lt;-</span><span class="cf">function</span>(a,k){</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span><span class="dv">0</span>;s0<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>k){</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  s0<span class="ot">&lt;-</span><span class="fu">kth_term</span>(a,i)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span>s<span class="sc">+</span>s0</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mysum</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mysum</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">400</span>)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<p><span class="math inline">\(\textbf{conclusion：}\)</span> We can see that the sum converges to 1.532164 when <span class="math inline">\(a=(1,2)^{T}\)</span></p>
<p><span class="math inline">\(\textbf{Answer2-11.5}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate c_k</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(k, u){</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">log</span>(pi<span class="sc">*</span>k)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  inte <span class="ot">&lt;-</span> tmp<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(inte)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>equation<span class="ot">&lt;-</span><span class="cf">function</span>(k, a){</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  up.bound<span class="fl">.1</span> <span class="ot">&lt;-</span>  <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  up.bound<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  integrate<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f,<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> up.bound<span class="fl">.1</span>, <span class="at">k =</span> k<span class="dv">-1</span>)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  integrate<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f,<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> up.bound<span class="fl">.2</span> , <span class="at">k =</span> k)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(integrate<span class="fl">.1</span><span class="sc">$</span>value <span class="sc">-</span> integrate<span class="fl">.2</span><span class="sc">$</span>value)</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>root <span class="ot">&lt;-</span> <span class="cf">function</span>(k){</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(equation, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.00001</span>, <span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">0.001</span>), <span class="at">k =</span> k)<span class="sc">$</span>root</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a)</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> k) {</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(<span class="fu">root</span>(i))</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1.313592
## [1] 1.428227
## [1] 1.492103
## [1] 1.533547
## [1] 1.562768
## [1] 1.584422
## [1] 1.601182
## [1] 1.614522
## [1] 1.625385
## [1] 1.634409
## [1] 1.642024
## [1] 1.64854
## [1] 1.654176
## [1] 1.659098</code></pre>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> We can see that the solution is in similar size of the points A(k) in Exercise 11.4.</p>
<p><span class="math inline">\(\mathbf{Answer3：EM-algorithm}\)</span>\ Solve: The likelihood function of the i.i.d sample <span class="math inline">\(T_{1}, \ldots, T_{n}\)</span> is： <span class="math display">\[
L(\lambda)=\prod_{i=1}^{n} \frac{1}{\lambda} \exp \left(-\frac{1}{\lambda} T_{i}\right)=(\frac{1}{\lambda})^{n} \exp \left(-\frac{1}{\lambda} \sum_{i=1}^{n} T_{i}\right)
\]</span> Then the log likelihood function of the sample is: <span class="math display">\[
 \ln L(\lambda)=-n \ln (\lambda)-\frac{1}{\lambda} \sum_{i=1}^{n} T_{i}
\]</span> when <span class="math inline">\(Y_{i}&lt;1\)</span>,<span class="math inline">\(E\left(T_{i} \mid Y_{i}, \lambda^{(k)}\right)=Y_{i}\)</span>,\ when <span class="math inline">\(Y_{i}=1\)</span>,<span class="math inline">\(E\left(T_{i} \mid Y_{i}, \lambda^{(k)}\right)=E\left(T_{i} \mid T_{i} \geqslant 1, \lambda^{(k)}\right)=\lambda^{(k)}+1\)</span>\ <span class="math display">\[\begin{aligned} \text { thus, the E-step is :} Q\left(\lambda \mid \lambda^{(k)}\right) &amp;=E\left(\ln L(\lambda)\mid \lambda^{(k)}, \vec{y}\right)=E\left(-10 \ln \lambda-\frac{\sum_{i=1}^{10} T_{i}}{\lambda} \mid \lambda^{(k)}, \vec{y}\right) \\ &amp;=-10 \ln \lambda-\lambda^{-1} \sum_{i=1}^{10} E\left(T_{i} \mid \lambda^{(k)},\vec{y}\right)=-10 \ln \lambda-\frac{\sum_{i=1}^{10} y_{i}+3 \lambda^{(k)}}{\lambda} \\ &amp;=-10 \ln \lambda-\frac{6.75+3 \lambda^{(k)}}{\lambda} \\
\text {the M-step is :} \frac{\partial Q}{\partial \lambda} &amp;=0 \Rightarrow \lambda^{(k+1)}=0.3 \lambda^{(k)}+0.675 \end{aligned}\]</span></p>
<p>The R code for this question is as follows:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>logL <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda) {</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># log-likelihood</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="sc">-</span><span class="dv">7</span><span class="sc">*</span><span class="fu">log</span>(lambda)<span class="sc">-</span><span class="fu">sum</span>(y)<span class="sc">/</span>lambda)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">optimize</span>(logL,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span><span class="dv">10</span>,<span class="at">maximum=</span><span class="cn">TRUE</span>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>maximum</span></code></pre></div>
<pre><code>## [1] 0.9642879</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the iterative formula of EM algorithm</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>lambda<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>lambda<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">abs</span>(lambda<span class="fl">.0</span> <span class="sc">-</span> lambda<span class="fl">.1</span>)<span class="sc">&gt;</span><span class="fl">1e-5</span>){</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  lambda<span class="fl">.0</span><span class="ot">&lt;-</span> lambda<span class="fl">.1</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  lambda<span class="fl">.1</span> <span class="ot">&lt;-</span> lambda<span class="fl">.0</span><span class="sc">*</span><span class="fl">0.3</span> <span class="sc">+</span> <span class="fl">0.675</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">MLE=</span>res<span class="sc">$</span>maximum,<span class="at">EM_estimate=</span>lambda<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## $MLE
## [1] 0.9642879
## 
## $EM_estimate
## [1] 0.964283</code></pre>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> We can see that The EM estimate is exactly the observed data MLE,i.e.,0.96428.</p>
</div>
<div id="section-9" class="section level2">
<h2>2021-11-25</h2>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>一、 Exercises 1 and 5 (page 204, Advanced R)\ 二、 Excecises 1 and 7 (page 214, Advanced R)</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(\mathbf{Answer1-11.1.2.1}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1.995804
## 
## [[2]]
## [1] 0.6121799
## 
## [[3]]
## [1] 0.3983687
## 
## [[4]]
## [1] 0.3206039</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1.995804
## 
## [[2]]
## [1] 0.6121799
## 
## [[3]]
## [1] 0.3983687
## 
## [[4]]
## [1] 0.3206039</code></pre>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> The pieces of x are always supplied as the first argument to f. So if we want to vary a different argument,we can use an anonymous function.The exercise varies the amount of trimming applied when computing the mean of a fixed x,which explains why the two invocations of lapply() are equivalent.</p>
<p><span class="math inline">\(\textbf{Answer2-11.1.2.5}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="do">#####exercise 3</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>mpg<span class="ot">&lt;-</span>mtcars<span class="sc">$</span>mpg</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>disp<span class="ot">&lt;-</span>mtcars<span class="sc">$</span>disp</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>wt<span class="ot">&lt;-</span>mtcars<span class="sc">$</span>wt</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co">#using for loop</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(formulas))</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)){</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  out[[i]] <span class="ot">&lt;-</span> <span class="fu">rsq</span>(<span class="fu">lm</span>(formulas[[i]]))</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>out<span class="co">#using for loop</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#using lapply()</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">lapply</span>(formulas, lm)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(fit,rsq)<span class="co">#using lapply()</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####exercise 4</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co">#using for loop</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(bootstraps))</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)){</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  out1[[i]] <span class="ot">&lt;-</span> <span class="fu">rsq</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> disp,<span class="at">data =</span> bootstraps[[i]]))</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>out1<span class="co">#using for loop</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6349728
## 
## [[2]]
## [1] 0.6441937
## 
## [[3]]
## [1] 0.7379684
## 
## [[4]]
## [1] 0.7693161
## 
## [[5]]
## [1] 0.6967375
## 
## [[6]]
## [1] 0.6685058
## 
## [[7]]
## [1] 0.6221949
## 
## [[8]]
## [1] 0.700972
## 
## [[9]]
## [1] 0.615796
## 
## [[10]]
## [1] 0.7254899</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#using lapply()</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">&lt;-</span><span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula=</span>mpg <span class="sc">~</span> disp)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(fit1, rsq)<span class="co">#using lapply()</span></span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6349728
## 
## [[2]]
## [1] 0.6441937
## 
## [[3]]
## [1] 0.7379684
## 
## [[4]]
## [1] 0.7693161
## 
## [[5]]
## [1] 0.6967375
## 
## [[6]]
## [1] 0.6685058
## 
## [[7]]
## [1] 0.6221949
## 
## [[8]]
## [1] 0.700972
## 
## [[9]]
## [1] 0.615796
## 
## [[10]]
## [1] 0.7254899</code></pre>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> We can see that both for loop and lapply() get the same result.</p>
<p><span class="math inline">\(\textbf{Answer3-11.2.5.1}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute the standard deviation of every column in a numeric data frame.</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">6</span>,<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">10</span>,<span class="at">rep=</span>T)))</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(df,sd,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="at">sd=</span><span class="dv">0</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    X1    X2    X3    X4    X5    X6 
## 2.283 3.127 3.093 3.107 3.433 2.983</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute the standard deviation of every numeric column in a mixed data frame.</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>mixdf<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">6</span>,<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">10</span>,<span class="at">rep=</span>T)),<span class="at">x7=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;f&quot;</span>,<span class="st">&quot;g&quot;</span>,<span class="st">&quot;h&quot;</span>,<span class="st">&quot;i&quot;</span>,<span class="st">&quot;j&quot;</span>))</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">&lt;-</span><span class="fu">vapply</span>(mixdf,is.numeric,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="at">c=</span><span class="dv">0</span>))</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mixdf[,tmp],sd,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="at">c=</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>##       X1     X1.1     X1.2     X1.3     X1.4     X1.5 
## 2.368778 2.368778 2.368778 2.368778 2.368778 2.368778</code></pre>
<p><span class="math inline">\(\textbf{Answer4-11.2.5.7}\)</span> Solve: The R code for this question is as follows:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>mcsapply <span class="ot">&lt;-</span> <span class="cf">function</span>(x,f){</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  num.clust <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">5</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">parSapply</span>(num.clust,x,f)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopCluster</span>(num.clust)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(f)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>tl <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>,<span class="fu">edist</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>),<span class="at">ncol=</span><span class="dv">10</span>),<span class="at">sizes=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>)))</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">mcsapply</span>(tl,<span class="cf">function</span>(x){<span class="fu">return</span>(x)}))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.03 0.91</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">sapply</span>(tl,<span class="cf">function</span>(x){<span class="fu">return</span>(x)}))</span></code></pre></div>
<pre><code>## 用户 系统 流逝 
##    0    0    0</code></pre>
<p><span class="math inline">\(\mathbf{conclusion：}\)</span> mcvapply()can implement.</p>
</div>
<div id="section-10" class="section level2">
<h2>2021-12-02</h2>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p><span class="math inline">\(\quad\)</span>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R). <span class="math inline">\(\quad\)</span>Compare the corresponding generated random numbers with pure R language using the function “qqplot”. <span class="math inline">\(\quad\)</span>Campare the computation time of the two functions with the function “microbenchmark”. <span class="math inline">\(\quad\)</span>Comments your results.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>The R code for this question is as follows:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#R-code</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>bivariate.density.R <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n){</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="dv">5000</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  burn<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(n<span class="sc">/</span><span class="dv">2</span>, <span class="fl">0.5</span>) <span class="co">#initialize</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x1<span class="sc">+</span>a, n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a><span class="co">#C++code</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix bivariate_density_c(double a,double b,double n){</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="st">  int N=5000;</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a><span class="st">  int burn=1000;</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix X(N,2);</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericVector v={n/2,0.5};</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a><span class="st">  X(0,_)=v;</span></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a><span class="st">  for(int i=1;i&lt;N;i++){</span></span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a><span class="st">    double x2=X(i-1,1);</span></span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a><span class="st">    X(i,0)=as&lt;int&gt;(rbinom(1,n,x2));</span></span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a><span class="st">    int x1=X(i,0);</span></span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a><span class="st">    X(i,1)=as&lt;double&gt;(rbeta(1,x1+a,n-x1+b));</span></span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix x=X(Range(burn-1,N-1), Range(0,1));</span></span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a><span class="st">  return(x);</span></span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize</span></span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a><span class="co">#qqplot</span></span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>X.R<span class="ot">&lt;-</span><span class="fu">bivariate.density.R</span>(a,b,n)</span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a>X.C<span class="ot">&lt;-</span><span class="fu">bivariate_density_c</span>(a,b,n)</span>
<span id="cb104-44"><a href="#cb104-44" aria-hidden="true" tabindex="-1"></a>x.r<span class="fl">.1</span><span class="ot">&lt;-</span>X.R[,<span class="dv">1</span>]</span>
<span id="cb104-45"><a href="#cb104-45" aria-hidden="true" tabindex="-1"></a>x.r<span class="fl">.2</span><span class="ot">&lt;-</span>X.R[,<span class="dv">2</span>]</span>
<span id="cb104-46"><a href="#cb104-46" aria-hidden="true" tabindex="-1"></a>x.c<span class="fl">.1</span><span class="ot">&lt;-</span>X.C[,<span class="dv">1</span>]</span>
<span id="cb104-47"><a href="#cb104-47" aria-hidden="true" tabindex="-1"></a>x.c<span class="fl">.2</span><span class="ot">&lt;-</span>X.C[,<span class="dv">2</span>]</span>
<span id="cb104-48"><a href="#cb104-48" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(x.r<span class="fl">.1</span>,x.c<span class="fl">.1</span>,<span class="at">xlab =</span> <span class="st">&quot;Discrete variable from R&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Discrete variable from Rcpp&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(x.r<span class="fl">.2</span>,x.c<span class="fl">.2</span>,<span class="at">xlab =</span> <span class="st">&quot;Continuous variable from R&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;Continuous variable from Rcpp&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Campare the computation time</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">bivariate.density.R=</span><span class="fu">bivariate.density.R</span>(a,b,n), <span class="at">bivariate_density_c=</span><span class="fu">bivariate_density_c</span>(a,b,n))</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##                  expr       lq  median      uq
## 1 bivariate.density.R 30.34485 34.0264 44.9715
## 2 bivariate_density_c  2.41230  2.8397  3.2951</code></pre>
<p>Comments:<br />
1.From the figure, we conclude that if the generated chains converge, they have similar quantiles.<br />
2.We can conclude that the Rcpp function implement the same work as the R function do, but Rcpp function consume much less time.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
